# Ubidots Python API Client Test
By A.J. Brown <br/>
24 Aug 2022 <br/>
ansleybrown1337@gmail.com <br/>
Updated: 4 June 2024

![sugarbeet image](./figs/sugarbeets.png)
*Generated by Open AI's DALL-E 3*

## Description

A Python script that downloads Ubidots data via API for streamlined data
analysis.

The CSU Ag Water Quality Program (AWQP) is collaborating with Western Sugar to develop a cercospora leaf spot (CLS) sensor. CLS is a devastating disease that affects sugar beet crops, and the sensor is designed to detect the disease early to prevent crop loss. Currently, this script is designed to download data from Ubidots, a cloud-based data platform, to provide necessary information to University of Nebraska-Lincoln (UNL) collaborators for the CLS sensor project.

The script compiles a list of active CLS sensors, and their respective API IDs, from Ubidots. This information is then sent to UNL collaborators for raw data streaming to their online decision support system (DSS) that calculates the risk of CLS infection based on sensor data, which can be found [here](https://phrec-irrigation.com/#/cls_monitoring).

## Code

File 1, "ubidots_python_api_test.py", uses the Ubidots API Client module.

File 2, "ubidots_python_api_test_HTTP.py" uses HTTP protocols. **(preferred method)**

## Documentation

In the [documentation folder](./documentation/), you will find instructions on how to run the code via IPython development environment OR terminal (preferred).

### How to get Ubidots CLS Sensor API Keys and lat/long via terminal
A detailed pdf guide can be found [here in the documentation folder](./documentation/how-to-use-exe-WesternSugar.pdf). This guide will walk you through the process of obtaining the necessary API keys and lat/long coordinates for the CLS sensors.

> [!TIP]
> If you just want to run the code and get the updated WS GPS data output, you can [email me](mailto:ansley.brown@colostate.edu) and ask for the .exe file that compiles this without the need for python installation. This will automatically download the data and provide the output in the folder where the .exe file is located. **Note: this EXE file is only available for Windows users.**

How to execute the script from the terminal:

1. Open your terminal (Command Prompt, PowerShell, or any terminal emulator).
2. Navigate to the directory where your script is located. For example:

    `cd C:\Users\AJ-CPU\Documents\GitHub\Ubidots-Python-API-Client-Test\code`
    
3. Activate your virtual environment if necessary. For example:

    `activate playground2`

4. Run the script using Python. Make sure you have your virtual environment 
   activated if necessary. The command to run the script is:

    `python ubidots_python_api_test_HTTP.py`

5. You will be prompted to enter your API token. 

    `Please enter your API token:`

    Enter the token and press Enter.

After following these steps, the script will execute, make the request using the
provided token, and print "Dataframe export complete." once the process is 
finished. The resulting CSV file will contain a list of all CLS sensor device types on Ubidots

## Output

The output folder contains the data downloaded from Ubidots, which has been cleaned and made ready for providing necessary information to UNL collaborators for the cercospora sensor project between AWQP and Western Sugar.

## Contact
For more information on this code, or to learn more about the CLS sensor project, please contact me at Ansley.Brown@colostate.edu or visit the AWQP website [here](https://www.csuagwaterquality.com/).
